{% load staticfiles %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>NASA EARTH TRASH</title>

  <script src ="https://cdnjs.cloudflare.com/ajax/libs/vue/2.3.4/vue.js"></script>
  <script src ="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.3.4/leaflet.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/es6-promise@4/dist/es6-promise.auto.js"></script>
  <script src ="https://unpkg.com/vuex@3.1.1/dist/vuex.js"></script>
  <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
  <script type="text/javascript" src="{% static "map/js/cb.js" %}"></script>
  <script type="text/javascript" src="{% static "map/js/sprintf.min.js" %}"></script>
  <script type="text/javascript" src="{% static "map/js/cb.date.js" %}"></script>
  <script type="text/javascript" src="{% static "axios/axios.min.js" %}"></script>
  <script type="text/javascript" src="{% static "axios/axios-csrf.js" %}"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js"></script>

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.css" />
  <link rel ="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.3.4/leaflet.css">

  <style>
    body {
      padding: 0;
      margin: 0;
    }
    #app, #earth_map {
      width: 100%;
      height: 100%;
    }
  </style>
</head>
<body>
  <div id="app" class="box">
    <div id="earth_map">
    </div>
  </div>
<script type="text/babel" data-presets="es2015,stage-2">
Vue.config.devtools = true;

const GV = {} || GV

GV.urls = {
    SATELLITE_TILE_URL: "{{ SATELLITE_TILE_URL }}"
}


window.gds = new Vue({
  el: '#app',
  delimiters: ["[[", "]]"],
  data: {
    map: null,
  },

  components: {
  },

  mounted() {
    this.initMap();
  },

  computed: {
  },

  methods: {
    initMap() {
      this.setMapSize()
      window.onresize = this.setMapSize

      let southWest = L.latLng(-90, 180),
          northEast = L.latLng(90., -180);

      this.map = L.map('earth_map', {
        center: new L.LatLng(24.20, 120.85),
        zoom: 6,
        maxZoom: 13,
        minZoom: 2,
        maxBounds: L.latLngBounds(southWest, northEast),
      });

      this.map.attributionControl.setPrefix('Power by iEducation');
      L.tileLayer(GV.urls.SATELLITE_TILE_URL, {
        tileSize: 512,
        zoomOffset: -1,
        minZoom: 1,
        attribution: '<a href="https://www.maptiler.com/copyright/" target="_blank">© MapTiler</a> <a href="https://www.openstreetmap.org/copyright" target="_blank">© OpenStreetMap contributors</a>',
        crossOrigin: true
      }).addTo(this.map);

      this.map.on("mousemove", e => {
        let _s = sprintf("%0.4f , %0.4f | Power by iEducation", e.latlng.lng, e.latlng.lat);
        this.map.attributionControl.setPrefix(_s);
      })
    },

    setMapSize() {
      document.getElementById('earth_map').style.height = window.innerHeight + 'px'

      if (this.map) {
        this.map.invalidateSize()
      }
    },
  },
  watch: {

  },
});
</script>
</body>
</html>
